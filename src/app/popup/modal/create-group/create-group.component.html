<div (click)="closeModal()" class="overlay-backdrop"></div>

<div class="modal-wrapper">
  <h4>Створення групи</h4>
  <form [formGroup]="groupEntityForm" class="tt-form">
    <div class="column">

      <label class="tt-input-label">
        <span class="placeholder">Назва *</span>
        <input class="tt-input" formControlName="name" placeholder="Введіть ім'я">
        <span class="tt-error">{{getControlError(groupEntityForm, 'name')}}</span>
      </label>
      <label class="tt-input-label">
        <span class="placeholder">Коротка назва *</span>
        <input class="tt-input" formControlName="short_name" placeholder="Введіть коротке ім'я">
        <span class="tt-error">{{getControlError(groupEntityForm, 'short_name')}}</span>
      </label>
      <label class="tt-input-label">
        <span class="placeholder">Транслітерація назви</span>
        <input class="tt-input" formControlName="slug" placeholder="Введіть slug">
        <span class="tt-error">{{getControlError(groupEntityForm, 'slug')}}</span>
      </label>
      <label class="tt-input-label">
        <span class="placeholder">Кількість підгруп *</span>
        <input class="tt-input" type="number" formControlName="subgroups" placeholder="Введіть кількість підгруп">
        <span class="tt-error">{{getControlError(groupEntityForm, 'subgroups')}}</span>
      </label>
    </div>

    <div class="column">
      <label class="tt-input-label">
        <span class="placeholder">Університет</span>
        <app-university-select [selectControl]="univControl"></app-university-select>
        <span class="tt-error">{{getControlError(groupEntityForm, 'univ')}}</span>
      </label>
      <label class="tt-input-label">
        <span class="placeholder">Факультет</span>
        <app-faculty-select [filters]="{univ: univControl.value}"
                            [selectControl]="facControl"
                            [dropByFilterKeys]="['univ']"
                            [dropByFilterDefinition]="false"
                            (selectedOptionLoad)="onLoadFaculty($event)"></app-faculty-select>
        <span class="tt-error">{{getControlError(groupEntityForm, 'faculty')}}</span>
      </label>
      <label class="tt-input-label">
        <span class="placeholder">Спеціальність</span>
        <app-specialty-select [filters]="{univ: univControl.value, faculty: facControl.value}"
                              [selectControl]="specControl"
                              [dropByFilterKeys]="['univ', 'faculty']"
                              [dropByFilterDefinition]="false"
                              (selectedOptionLoad)="onLoadSpecialty($event)"></app-specialty-select>
        <span class="tt-error">{{getControlError(groupEntityForm, 'specialty')}}</span>
      </label>
      <label class="tt-input-label">
        <span class="placeholder">Курс *</span>
        <app-course-select [selectControl]="courseControl"
                           [disabled]="!specControl.value"
                           [filters]="{univ: univControl.value, faculty: facControl.value, specialty: specControl.value}"
                           [dropByFilterKeys]="['univ', 'faculty', 'specialty']"
                           [dropByFilterDefinition]="false"
                           (selectedOptionLoad)="onLoadCourse($event)"></app-course-select>
        <span class="tt-error">{{getControlError(groupEntityForm, 'course')}}</span>
      </label>
      <label class="tt-input-label">
        <span class="placeholder">Рік *</span>
        <app-year-select [selectControl]="yearControl"
                         [filters]="{univ: univControl.value}"
                         [dropByFilterKeys]="['univ']"
                         [dropByFilterDefinition]="false"></app-year-select>
        <span class="tt-error">{{getControlError(groupEntityForm, 'course')}}</span>
      </label>
    </div>
  </form>
  <div class="control-row">
    <button (click)="createFaculty()"
            [disabled]="groupEntityForm.invalid"
            color="primary"
            mat-flat-button>Зберегти
    </button>
    <button mat-stroked-button (click)="closeModal()">Скинути</button>
  </div>
  <div class="loading-wrapper" *ngIf="isLoading">
    <div class="loader-wrapper">
      <mat-spinner></mat-spinner>
    </div>
  </div>
</div>
